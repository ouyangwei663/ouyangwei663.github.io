<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>å¾®å‰ç«¯å°è¯• | åšå®¢</title>
    <meta name="description" content="">
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/favicon.ico">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.css">
    <meta name="description" content="Hi">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <link rel="preload" href="/assets/css/0.styles.75e7fe11.css" as="style"><link rel="preload" href="/assets/js/app.053dbcbc.js" as="script"><link rel="preload" href="/assets/js/2.7f8ecedc.js" as="script"><link rel="preload" href="/assets/js/11.aebc598d.js" as="script"><link rel="prefetch" href="/assets/js/10.4b10b7ab.js"><link rel="prefetch" href="/assets/js/12.27ab6a74.js"><link rel="prefetch" href="/assets/js/13.09d6c27f.js"><link rel="prefetch" href="/assets/js/14.e4a3d6cc.js"><link rel="prefetch" href="/assets/js/15.13db9c56.js"><link rel="prefetch" href="/assets/js/16.e210dca5.js"><link rel="prefetch" href="/assets/js/17.05f5e78e.js"><link rel="prefetch" href="/assets/js/18.6e75a0a6.js"><link rel="prefetch" href="/assets/js/19.e45d34bd.js"><link rel="prefetch" href="/assets/js/20.f6497181.js"><link rel="prefetch" href="/assets/js/3.17b2d5e4.js"><link rel="prefetch" href="/assets/js/4.00d5efe8.js"><link rel="prefetch" href="/assets/js/5.f71f9b07.js"><link rel="prefetch" href="/assets/js/6.a16f5917.js"><link rel="prefetch" href="/assets/js/7.dba0ee9b.js"><link rel="prefetch" href="/assets/js/8.198b1090.js"><link rel="prefetch" href="/assets/js/9.9c23ba08.js">
    <link rel="stylesheet" href="/assets/css/0.styles.75e7fe11.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="ant-row"><div class="nav-button"><i aria-label="icon: bars" class="anticon anticon-bars"><svg viewBox="0 0 1024 1024" focusable="false" data-icon="bars" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0z"></path></svg></i> <span></span></div> <div class="ant-col ant-col-xs-24 ant-col-sm-24 ant-col-md-6 ant-col-lg-5 ant-col-xl-5 ant-col-xxl-4"><a href="/" class="router-link-active home-link"><img src="/logo.jpg" alt="åšå®¢" class="logo"> <span class="site-name">åšå®¢</span></a> <div class="search-box mobile-search"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div> <div class="ant-col ant-col-xs-0 ant-col-sm-0 ant-col-md-18 ant-col-lg-19 ant-col-xl-19 ant-col-xxl-20"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><ul role="menu" id="nav" class="ant-menu ant-menu-horizontal ant-menu-root ant-menu-light"><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>Â·Â·Â·</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/" class="router-link-active">
          é¦–é¡µ
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>Â·Â·Â·</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item ant-menu-item-selected"><a href="/front-end/" class="router-link-active">
          ğŸƒå‰ç«¯
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>Â·Â·Â·</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/notes/">
          ğŸ“’ç¬”è®°
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>Â·Â·Â·</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>
          ğŸŒ±å…¶ä»–
        </span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>Â·Â·Â·</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>
          ğŸŒˆè”ç³»
        </span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="visibility:hidden;position:absolute;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>Â·Â·Â·</span><i class="ant-menu-submenu-arrow"></i></div></li></ul> <!----></nav></div></div> <!----></header> <aside class="sidebar"><!----> <ul class="sidebar-links"><li><a href="/front-end/" aria-current="page" title="å‰ç«¯" class="sidebar-link">å‰ç«¯</a></li><li><a href="/front-end/åœ¨VScodeä¸­è¿›è¡Œè°ƒè¯•.html" title="åœ¨VScodeä¸­è¿›è¡Œè°ƒè¯•" class="sidebar-link">åœ¨VScodeä¸­è¿›è¡Œè°ƒè¯•</a></li><li><a href="/front-end/å…ƒç´ è§†å£äº¤å‰.html" title="å…ƒç´ è§†å£äº¤å‰" class="sidebar-link">å…ƒç´ è§†å£äº¤å‰</a></li><li><a href="/front-end/Flexå¸ƒå±€.html" title="Flexå¸ƒå±€" class="sidebar-link">Flexå¸ƒå±€</a></li></ul></aside> <main class="page"> <div class="theme-antdocs-content content__default"><h1 id="å¾®å‰ç«¯å°è¯•"><a href="#å¾®å‰ç«¯å°è¯•" class="header-anchor">#</a> å¾®å‰ç«¯å°è¯•</h1> <h2 id="å¾®å‰ç«¯"><a href="#å¾®å‰ç«¯" class="header-anchor">#</a> å¾®å‰ç«¯</h2> <p>ä¸‹æ–‡æ—¨åœ¨æµ…ç•¥å°è¯•å¾®å‰ç«¯æ­å»ºã€‚</p> <p>å¾®å‰ç«¯å…ˆä»å¾®æœåŠ¡è¯´èµ·ï¼Œå¾®æœåŠ¡æ˜¯ä¸€ç§è½¯ä»¶æ¶æ„é£æ ¼ï¼Œä»¥ä¸“æ³¨äºå•ä¸€è´£ä»»ä¸åŠŸèƒ½çš„å°å‹åŠŸèƒ½åŒºå—ä¸ºåŸºç¡€ï¼Œåˆ©ç”¨æ¨¡å—åŒ–çš„æ–¹å¼ç»„åˆå‡ºå¤æ‚çš„å¤§å‹åº”ç”¨ç¨‹åºï¼Œå„åŠŸèƒ½å—ä¸è¯­è¨€æ— å…³ã€‚</p> <p>åœ¨å¾®å‰ç«¯è¿™è¾¹ï¼Œéšç€å·¥ç¨‹åŒ–ã€ç»„ä»¶åŒ–çš„å…´èµ·ï¼Œå‰ç«¯å¤§éƒ¨åˆ†ä»£ç éƒ½å¯ä»¥å®ç°æŠ½ç¦»ï¼Œå„è‡ªç»´æŠ¤ç®¡ç†ï¼Œä½†å½“é¡¹ç›®è¿­ä»£åˆ°ä¸€å®šç¨‹åº¦å˜æˆå·¨çŸ³åº”ç”¨æ—¶ï¼Œå®¹æ˜“å‡ºç°ä¿®æ”¹ä¸€åˆ†é’Ÿï¼Œç¼–è¯‘åŠå°æ—¶â€çš„æƒ…å†µï¼Œè¦æ˜¯æ¨¡å—éš”ç¦»ä¸å¤Ÿå¤æ‚ï¼Œä»£ç ä¸å¤Ÿè§„èŒƒï¼Œè¿˜å®¹æ˜“å‡ºç°æ¨¡å—é”™ç»¼å¤æ‚ï¼Œäº’ç›¸ä¾èµ–ï¼Œæ›´æ”¹ä¸€å¤„åœ°æ–¹çš„ä»£ç ï¼Œå¾€å¾€ä¼šå½±å“åˆ°åº”ç”¨çš„å…¶ä»–åŠŸèƒ½ã€‚</p> <p>å¾®å‰ç«¯å¥½å¤„ï¼šçœŸæ­£å®ç°å„æœåŠ¡è§£è€¦ï¼ŒæœåŠ¡é—´ç›¸äº’ç‹¬ç«‹ç®¡ç†ï¼Œå¯ä»¥çµæ´»å¢å‡æœåŠ¡ï¼Œä¾‹å¦‚ï¼Œä¸€ä¸ªåº”ç”¨åˆ†ä¸º ABCD å››ä¸ªé¡µé¢ï¼Œæ¯ä¸ªé¡µé¢å•ç‹¬æ³¨å†Œä¸ºä¸€ä¸ªæœåŠ¡ï¼ŒA æœåŠ¡ä¸å¯ç”¨æ—¶ï¼ŒBCD ä¸å—å½±å“ï¼ŒåŒæ—¶å¯ä»¥çµæ´»ä¸Šçº¿ E åº”ç”¨æˆ–ä¸‹çº¿ D åº”ç”¨ã€‚</p> <p>å¾®å‰ç«¯éš¾ç‚¹ï¼šéš¾ä»¥ç¡®å®šæœåŠ¡è¾¹ç•Œï¼Œå½“ä¸€ä¸ªåº”ç”¨åŠŸèƒ½å¤ªå¤šæ—¶ï¼Œå¾€å¾€å…³è”è¾ƒæ·±ï¼Œéš¾ä»¥ç¡®å®šå½’å±ã€‚</p> <p>ä¸€å¥è¯æ€»ç»“ï¼šå¾®å‰ç«¯å¥½å¤„å¤šä½†ä¹Ÿæœ‰é™åˆ¶ï¼Œä»…é€‚åˆå¤§å‹å·¨çŸ³é¡¹ç›®ï¼Œä¸”ç›®å‰ä»…æœ‰èš‚èš qiankun æ¡†æ¶å¼€æºï¼Œå…¶æ ¸å¿ƒåŸç†è¿˜æ˜¯å°†åŠŸèƒ½æ¨¡å—å•ç‹¬æŠ½ç¦»å„è‡ªç»´æŠ¤ï¼Œçœ‹ä¼¼ä¹Ÿæ˜¯è½¯ä»¶æ¶æ„ä¸‡å˜ä¸ç¦»å…¶å®—çš„æ–¹æ³•ã€‚</p> <h2 id="å¾®æœåŠ¡è¡¥å……"><a href="#å¾®æœåŠ¡è¡¥å……" class="header-anchor">#</a> å¾®æœåŠ¡è¡¥å……</h2> <blockquote><p>é‡‡ç”¨æ–°æŠ€æœ¯ï¼Œæ›´å¤šä¸æ˜¯å› ä¸ºå…ˆè¿›ï¼Œè€Œæ˜¯å› ä¸ºå®ƒèƒ½è§£å†³ç—›ç‚¹ã€‚
å‰ç«¯å¾®æœåŠ¡è§£å†³çš„ç—›ç‚¹æœ‰å¦‚ä¸‹å‡ ä¸ªï¼š</p></blockquote> <ol><li><p>è§£å†³é—ç•™ç³»ç»Ÿé—®é¢˜ï¼š
è¿™åº”è¯¥æ˜¯æœ€ä¸»è¦ä½¿ç”¨å¾®æœåŠ¡çš„åŸå› ï¼Œä¸€äº›å…¬å¸å†å²åº”ç”¨æ­£å¸¸è¿è¡Œä¹Ÿæ²¡æœ‰ä»€ä¹ˆæ–°åŠŸèƒ½ï¼Œä½†éšç€å…¬å¸å‘å±•æˆ–ä¸šåŠ¡å¢é•¿ï¼Œä¸æ–­æœ‰æ–°çš„åº”ç”¨å¹¶å…¥è¿›æ¥ï¼ˆä½¿ç”¨æ–°çš„æŠ€æœ¯ï¼‰ï¼Œå¯¹äºè¿™ç±»é—ç•™ç³»ç»Ÿï¼Œæ˜¾ç„¶æˆ‘ä»¬èŠ±æ—¶é—´ç²¾åŠ›å»é‡å†™å¹¶æ²¡æœ‰æ„ä¹‰ï¼Œåœ¨å³ä¸é‡å†™åŸæœ‰ç³»ç»Ÿçš„åŸºç¡€ä¹‹ä¸‹ï¼Œåˆå¯ä»¥æŠ½å‡ºäººåŠ›æ¥å¼€å‘æ–°çš„ä¸šåŠ¡ã€‚å…¶ä¸ä»…ä»…å¯¹äºä¸šåŠ¡äººå‘˜æ¥è¯´ï¼Œæ˜¯ä¸€ä¸ªç›¸å½“å¸å¼•åŠ›çš„ç‰¹æ€§ï¼›å¯¹äºæŠ€æœ¯äººå‘˜æ¥è¯´ï¼Œä¸é‡å†™æ—§çš„ä¸šåŠ¡ï¼ŒåŒæ—¶è¿˜èƒ½åšä¸€äº›æŠ€æœ¯ä¸Šçš„æŒ‘æˆ˜ï¼Œä¹Ÿæ˜¯ä¸€ä»¶ç›¸å½“æœ‰æŒ‘æˆ˜çš„äº‹æƒ…ã€‚</p></li> <li><p>èšåˆä¸šåŠ¡
å¯¹äºæœ‰å…³è”çš„åº”ç”¨æ¥è¯´ï¼Œç”¨æˆ·æ›´å¸Œæœ›èƒ½ç›´æ¥ä»ä¸€ä¸ªå…¥å£è¿›å…¥ï¼Œè€Œåœ¨å‰ç«¯è¿™è¾¹ï¼Œè™½ç„¶å¯ä»¥å®ç°é“¾æ¥è·³è½¬ï¼Œä½†å­˜åœ¨ç”¨æˆ·é‰´æƒã€é¡µé¢è·³è½¬ä½“éªŒç­‰é—®é¢˜ï¼Œèšåˆä¸šåŠ¡ï¼Œç”¨æˆ·å¯ä»¥æ— æ„Ÿçš„ä½¿ç”¨å‡ ä¸ªç‹¬ç«‹è¿è¡Œéƒ¨ç½²çš„åº”ç”¨ã€‚</p></li></ol> <h2 id="single-spa"><a href="#single-spa" class="header-anchor">#</a> single-spa</h2> <p>Single-spa æ˜¯ä¸€ä¸ªå°†å¤šä¸ªå•é¡µé¢åº”ç”¨èšåˆä¸ºä¸€ä¸ªæ•´ä½“åº”ç”¨çš„ JavaScript å¾®å‰ç«¯æ¡†æ¶ã€‚ ä½¿ç”¨ single-spa è¿›è¡Œå‰ç«¯æ¶æ„è®¾è®¡å¯ä»¥å¸¦æ¥å¾ˆå¤šå¥½å¤„ï¼Œä¾‹å¦‚:</p> <blockquote><p>åœ¨åŒä¸€é¡µé¢ä¸Šä½¿ç”¨å¤šä¸ªå‰ç«¯æ¡†æ¶ è€Œä¸ç”¨åˆ·æ–°é¡µé¢ (React, AngularJS, Angular, Ember, ä½ æ­£åœ¨ä½¿ç”¨çš„æ¡†æ¶)
ç‹¬ç«‹éƒ¨ç½²æ¯ä¸€ä¸ªå•é¡µé¢åº”ç”¨
æ–°åŠŸèƒ½ä½¿ç”¨æ–°æ¡†æ¶ï¼Œæ—§çš„å•é¡µåº”ç”¨ä¸ç”¨é‡å†™å¯ä»¥å…±å­˜
æ”¹å–„åˆå§‹åŠ è½½æ—¶é—´ï¼Œè¿ŸåŠ è½½ä»£ç </p></blockquote> <p>Single-spa ä¸è¦æ±‚å…·ä½“æŠ€æœ¯ï¼Œé€‚ç”¨ä»»ä½•å¯ç”¨çš„æ„å»ºç³»ç»Ÿã€‚</p> <p>å°è¯•ï¼šæ­å»ºå¾®å‰ç«¯ demo</p> <h3 id="æ­å»ºå­æœåŠ¡"><a href="#æ­å»ºå­æœåŠ¡" class="header-anchor">#</a> æ­å»ºå­æœåŠ¡</h3> <h4 id="æ–°å»º-app-1-æœåŠ¡"><a href="#æ–°å»º-app-1-æœåŠ¡" class="header-anchor">#</a> æ–°å»º app_1 æœåŠ¡</h4> <div class="language-bash extra-class"><pre class="language-bash"><code>vue create app_1
</code></pre></div><h4 id="é…ç½®"><a href="#é…ç½®" class="header-anchor">#</a> é…ç½®</h4> <p>æ–°å»º vue.config.js</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token keyword">package</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./package.json'</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// å‘Šè¯‰å­åº”ç”¨åœ¨è¿™ä¸ªåœ°å€åŠ è½½é™æ€èµ„æºï¼Œå¦åˆ™ä¼šå»åŸºåº§åº”ç”¨çš„åŸŸåä¸‹åŠ è½½</span>
    publicPath<span class="token operator">:</span> <span class="token string">'//localhost:8081'</span><span class="token punctuation">,</span>
    <span class="token comment">// å¼€å‘æœåŠ¡å™¨</span>
    devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
        port<span class="token operator">:</span> <span class="token number">8081</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    configureWebpack<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// å¯¼å‡ºumdæ ¼å¼çš„åŒ…ï¼Œåœ¨å…¨å±€å¯¹è±¡ä¸ŠæŒ‚è½½å±æ€§package.nameï¼ŒåŸºåº§åº”ç”¨éœ€è¦é€šè¿‡è¿™ä¸ªå…¨å±€å¯¹è±¡è·å–ä¸€äº›ä¿¡æ¯ï¼Œæ¯”å¦‚å­åº”ç”¨å¯¼å‡ºçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°</span>
        output<span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token comment">// libraryçš„å€¼åœ¨æ‰€æœ‰å­åº”ç”¨ä¸­éœ€è¦å”¯ä¸€</span>
            library<span class="token operator">:</span> <span class="token keyword">package</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span>
            libraryTarget<span class="token operator">:</span> <span class="token string">'umd'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="å®‰è£…-single-spa-vue"><a href="#å®‰è£…-single-spa-vue" class="header-anchor">#</a> å®‰è£… single-spa-vue</h4> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> i single-spa-vue -S
</code></pre></div><h4 id="æ”¹é€ å…¥å£æ–‡ä»¶"><a href="#æ”¹é€ å…¥å£æ–‡ä»¶" class="header-anchor">#</a> æ”¹é€ å…¥å£æ–‡ä»¶</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// /src/main.js</span>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App.vue'</span>
<span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">'./router'</span>
<span class="token keyword">import</span> singleSpaVue <span class="token keyword">from</span> <span class="token string">'single-spa-vue'</span>

Vue<span class="token punctuation">.</span>config<span class="token punctuation">.</span>productionTip <span class="token operator">=</span> <span class="token boolean">false</span>

<span class="token keyword">const</span> appOptions <span class="token operator">=</span> <span class="token punctuation">{</span>
    el<span class="token operator">:</span> <span class="token string">'#microApp'</span><span class="token punctuation">,</span>
    router<span class="token punctuation">,</span>
    <span class="token function-variable function">render</span><span class="token operator">:</span> <span class="token parameter">h</span> <span class="token operator">=&gt;</span> <span class="token function">h</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// æ”¯æŒåº”ç”¨ç‹¬ç«‹è¿è¡Œã€éƒ¨ç½²ï¼Œä¸ä¾èµ–äºåŸºåº§åº”ç”¨</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>window<span class="token punctuation">.</span>singleSpaNavigate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">delete</span> appOptions<span class="token punctuation">.</span>el
    <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span>appOptions<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// åŸºäºåŸºåº§åº”ç”¨ï¼Œå¯¼å‡ºç”Ÿå‘½å‘¨æœŸå‡½æ•°</span>
<span class="token keyword">const</span> vueLifecycle <span class="token operator">=</span> <span class="token function">singleSpaVue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    Vue<span class="token punctuation">,</span>
    appOptions<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'app_1 bootstrap'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> vueLifecycle<span class="token punctuation">.</span><span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">mount</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'app_1 mount'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> vueLifecycle<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">unmount</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'app_1 unmount'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> vueLifecycle<span class="token punctuation">.</span><span class="token function">unmount</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="ç¯å¢ƒé…ç½®æ–‡ä»¶"><a href="#ç¯å¢ƒé…ç½®æ–‡ä»¶" class="header-anchor">#</a> ç¯å¢ƒé…ç½®æ–‡ä»¶</h4> <p>.env åº”ç”¨ç‹¬ç«‹è¿è¡Œæ—¶çš„å¼€å‘ç¯å¢ƒé…ç½®</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token constant">NODE_ENV</span><span class="token operator">=</span>development
<span class="token constant">VUE_APP_BASE_URL</span><span class="token operator">=</span><span class="token operator">/</span>
</code></pre></div><p>.env.micro ä½œä¸ºå­åº”ç”¨è¿è¡Œæ—¶çš„å¼€å‘ç¯å¢ƒé…ç½®</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token constant">NODE_ENV</span><span class="token operator">=</span>development
<span class="token constant">VUE_APP_BASE_URL</span><span class="token operator">=</span><span class="token operator">/</span>app1
</code></pre></div><p>.env.buildMicro ä½œä¸ºå­åº”ç”¨æ„å»ºç”Ÿäº§ç¯å¢ƒ<code>bundle</code>æ—¶çš„ç¯å¢ƒé…ç½®ï¼Œä½†è¿™é‡Œçš„<code>NODE_ENV</code>ä¸º<code>development</code>ï¼Œè€Œä¸æ˜¯<code>production</code>ï¼Œæ˜¯ä¸ºäº†æ–¹ä¾¿ï¼Œè¿™ä¸ªæ–¹ä¾¿å…¶å®<code>single-spa</code>å¸¦æ¥çš„å¼Šç«¯ï¼ˆjs entry çš„å¼Šç«¯ï¼‰</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token constant">NODE_ENV</span><span class="token operator">=</span>development
<span class="token constant">VUE_APP_BASE_URL</span><span class="token operator">=</span><span class="token operator">/</span>app1
</code></pre></div><h4 id="ä¿®æ”¹è·¯ç”±æ–‡ä»¶"><a href="#ä¿®æ”¹è·¯ç”±æ–‡ä»¶" class="header-anchor">#</a> ä¿®æ”¹è·¯ç”±æ–‡ä»¶</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// /src/router/index.js</span>
<span class="token comment">// ...</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    mode<span class="token operator">:</span> <span class="token string">'history'</span><span class="token punctuation">,</span>
    <span class="token comment">// é€šè¿‡ç¯å¢ƒå˜é‡æ¥é…ç½®è·¯ç”±çš„ base url</span>
    base<span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VUE_APP_BASE_URL</span><span class="token punctuation">,</span>
    routes<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// ...</span>
</code></pre></div><h4 id="ä¿®æ”¹-package-json"><a href="#ä¿®æ”¹-package-json" class="header-anchor">#</a> ä¿®æ”¹ package.json</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;app_1&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// ...</span>
  <span class="token string">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// ç‹¬ç«‹è¿è¡Œ</span>
    <span class="token string">&quot;serve&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vue-cli-service serve&quot;</span><span class="token punctuation">,</span>
    <span class="token comment">// ä½œä¸ºå­åº”ç”¨è¿è¡Œ</span>
    <span class="token string">&quot;serve:micro&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vue-cli-service serve --mode micro&quot;</span><span class="token punctuation">,</span>
    <span class="token comment">// æ„å»ºå­åº”ç”¨</span>
    <span class="token string">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vue-cli-service build --mode buildMicro&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="å¯åŠ¨åº”ç”¨"><a href="#å¯åŠ¨åº”ç”¨" class="header-anchor">#</a> å¯åŠ¨åº”ç”¨</h4> <div class="language-text extra-class"><pre class="language-text"><code>ç‹¬ç«‹è¿è¡Œ  npm run serve
ä½œä¸ºå­åº”ç”¨è¿è¡Œ npm run serve:micro
</code></pre></div><p>åŒæ ·çš„æ–¹æ³•åˆ›å»º demo2ï¼Œå¯¹æŠ€æœ¯æ ˆæ— è¦æ±‚ï¼Œ</p> <p>å®ç°æ•ˆæœ</p> <p><img src="/assets/imgs/1631152850438.png" alt="1631152850438"></p> <p><strong><img src="/assets/imgs/1631152867139.png" alt="1631152867139"></strong></p> <h3 id="æ­å»ºåŸºåº§åº”ç”¨-å¯ä»¥ç®—æ˜¯å…¥å£åº”ç”¨"><a href="#æ­å»ºåŸºåº§åº”ç”¨-å¯ä»¥ç®—æ˜¯å…¥å£åº”ç”¨" class="header-anchor">#</a> æ­å»ºåŸºåº§åº”ç”¨ï¼Œå¯ä»¥ç®—æ˜¯å…¥å£åº”ç”¨</h3> <h4 id="æ¨¡æ¿åˆ›å»º"><a href="#æ¨¡æ¿åˆ›å»º" class="header-anchor">#</a> æ¨¡æ¿åˆ›å»º</h4> <div class="language-bash extra-class"><pre class="language-bash"><code>vue create layer
</code></pre></div><h4 id="å®‰è£…-single-spa"><a href="#å®‰è£…-single-spa" class="header-anchor">#</a> å®‰è£… single-spa</h4> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> i single-spa -S
</code></pre></div><h4 id="æ”¹é€ å…¥å£æ–‡ä»¶-2"><a href="#æ”¹é€ å…¥å£æ–‡ä»¶-2" class="header-anchor">#</a> æ”¹é€ å…¥å£æ–‡ä»¶</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App.vue'</span>
<span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">'./router'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> registerApplication<span class="token punctuation">,</span> start <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'single-spa'</span>

Vue<span class="token punctuation">.</span>config<span class="token punctuation">.</span>productionTip <span class="token operator">=</span> <span class="token boolean">false</span>

<span class="token comment">// è¿œç¨‹åŠ è½½å­åº”ç”¨</span>
<span class="token keyword">function</span> <span class="token function">createScript</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> script <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span>
        script<span class="token punctuation">.</span>src <span class="token operator">=</span> url
        script<span class="token punctuation">.</span>onload <span class="token operator">=</span> resolve
        script<span class="token punctuation">.</span>onerror <span class="token operator">=</span> reject
        <span class="token keyword">const</span> firstScript <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        firstScript<span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>script<span class="token punctuation">,</span> firstScript<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// è®°è½½å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ª promise</span>
<span class="token keyword">function</span> <span class="token function">loadApp</span><span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> globalVar</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// æ”¯æŒè¿œç¨‹åŠ è½½å­åº”ç”¨</span>
    <span class="token keyword">return</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">await</span> <span class="token function">createScript</span><span class="token punctuation">(</span>url <span class="token operator">+</span> <span class="token string">'/js/chunk-vendors.js'</span><span class="token punctuation">)</span>
        <span class="token keyword">await</span> <span class="token function">createScript</span><span class="token punctuation">(</span>url <span class="token operator">+</span> <span class="token string">'/js/app.js'</span><span class="token punctuation">)</span>
        <span class="token comment">// è¿™é‡Œçš„returnå¾ˆé‡è¦ï¼Œéœ€è¦ä»è¿™ä¸ªå…¨å±€å¯¹è±¡ä¸­æ‹¿åˆ°å­åº”ç”¨æš´éœ²å‡ºæ¥çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°</span>
        <span class="token keyword">return</span> window<span class="token punctuation">[</span>globalVar<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// å­åº”ç”¨åˆ—è¡¨</span>
<span class="token keyword">const</span> apps <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// å­åº”ç”¨åç§°</span>
        name<span class="token operator">:</span> <span class="token string">'app_1'</span><span class="token punctuation">,</span>
        <span class="token comment">// å­åº”ç”¨åŠ è½½å‡½æ•°ï¼Œæ˜¯ä¸€ä¸ªpromise</span>
        app<span class="token operator">:</span> <span class="token function">loadApp</span><span class="token punctuation">(</span><span class="token string">'http://localhost:8081'</span><span class="token punctuation">,</span> <span class="token string">'app_1'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token comment">// å½“è·¯ç”±æ»¡è¶³æ¡ä»¶æ—¶ï¼ˆè¿”å›trueï¼‰ï¼Œæ¿€æ´»ï¼ˆæŒ‚è½½ï¼‰å­åº”ç”¨</span>
        <span class="token function-variable function">activeWhen</span><span class="token operator">:</span> <span class="token parameter">location</span> <span class="token operator">=&gt;</span> location<span class="token punctuation">.</span>pathname<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">'/app_1'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token comment">// ä¼ é€’ç»™å­åº”ç”¨çš„å¯¹è±¡</span>
        customProps<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        name<span class="token operator">:</span> <span class="token string">'app_2'</span><span class="token punctuation">,</span>
        app<span class="token operator">:</span> <span class="token function">loadApp</span><span class="token punctuation">(</span><span class="token string">'http://localhost:8082'</span><span class="token punctuation">,</span> <span class="token string">'app_2'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function-variable function">activeWhen</span><span class="token operator">:</span> <span class="token parameter">location</span> <span class="token operator">=&gt;</span> location<span class="token punctuation">.</span>pathname<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">'/app_2'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        customProps<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

<span class="token comment">// æ³¨å†Œå­åº”ç”¨</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> apps<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">registerApplication</span><span class="token punctuation">(</span>apps<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    router<span class="token punctuation">,</span>
    <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// å¯åŠ¨</span>
        <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">render</span><span class="token operator">:</span> <span class="token parameter">h</span> <span class="token operator">=&gt;</span> <span class="token function">h</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="æ”¹é€ -app-vue"><a href="#æ”¹é€ -app-vue" class="header-anchor">#</a> æ”¹é€  app.vue</h4> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>nav<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/app_1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>app1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">&gt;</span></span> |
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/app_2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>app2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- å­åº”ç”¨å®¹å™¨ --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>microApp<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">#app</span> <span class="token punctuation">{</span>
    <span class="token property">font-family</span><span class="token punctuation">:</span> Avenir<span class="token punctuation">,</span> Helvetica<span class="token punctuation">,</span> Arial<span class="token punctuation">,</span> sans-serif<span class="token punctuation">;</span>
    <span class="token property">-webkit-font-smoothing</span><span class="token punctuation">:</span> antialiased<span class="token punctuation">;</span>
    <span class="token property">-moz-osx-font-smoothing</span><span class="token punctuation">:</span> grayscale<span class="token punctuation">;</span>
    <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">color</span><span class="token punctuation">:</span> #2c3e50<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">#nav</span> <span class="token punctuation">{</span>
    <span class="token property">padding</span><span class="token punctuation">:</span> 30px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">#nav a</span> <span class="token punctuation">{</span>
    <span class="token property">font-weight</span><span class="token punctuation">:</span> bold<span class="token punctuation">;</span>
    <span class="token property">color</span><span class="token punctuation">:</span> #2c3e50<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">#nav a.router-link-exact-active</span> <span class="token punctuation">{</span>
    <span class="token property">color</span><span class="token punctuation">:</span> #42b983<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h4 id="æ”¹é€ è·¯ç”±"><a href="#æ”¹é€ è·¯ç”±" class="header-anchor">#</a> æ”¹é€ è·¯ç”±</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> VueRouter <span class="token keyword">from</span> <span class="token string">'vue-router'</span>

Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>VueRouter<span class="token punctuation">)</span>

<span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    routes<span class="token punctuation">,</span>
    mode<span class="token operator">:</span> <span class="token string">'history'</span><span class="token punctuation">,</span>
    base<span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">BASE_URL</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> router
</code></pre></div><h4 id="è¿è¡Œ"><a href="#è¿è¡Œ" class="header-anchor">#</a> è¿è¡Œ</h4> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> run serve
</code></pre></div><h4 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="header-anchor">#</a> æµ‹è¯•</h4> <p><img src="/assets/imgs/1631155940868.png" alt="1631155940868"></p> <p><img src="/assets/imgs/1631156225347.png" alt="1631156225347"></p> <p><img src="/assets/imgs/1631156236899.png" alt="1631156236899"></p> <p>å¯å®ç°æ¯ä¸ªæœåŠ¡ç‹¬ç«‹è¿è¡Œï¼ŒåŸºåº§åº”ç”¨æ ¹æ®è·¯ç”±åŠ è½½å­æœåŠ¡ï¼Œ</p> <p><img src="/assets/imgs/1631157088701.png" alt="1631157088701"></p> <p>å­æœåŠ¡å«æœ‰å„è‡ªé’©å­å¯æŒ‰éœ€æ‰§è¡Œæ“ä½œã€‚</p> <h4 id="æ‰“åŒ…éƒ¨ç½²"><a href="#æ‰“åŒ…éƒ¨ç½²" class="header-anchor">#</a> æ‰“åŒ…éƒ¨ç½²</h4> <p>åœ¨å„ä¸ªé¡¹ç›®çš„æ ¹ç›®å½•ä¸‹åˆ†åˆ«æ‰§è¡Œ</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> run build
</code></pre></div><p>ä¸Šä¼ ã€é…ç½® nginx ä»£ç†</p> <blockquote><ul><li>å¯¹äºå­åº”ç”¨é™æ€èµ„æºçš„åŠ è½½åªéœ€è¦æ‹¦æˆªç›¸åº”çš„å‰ç¼€å°†è¯·æ±‚è½¬å‘åˆ°å¯¹åº”å­åº”ç”¨çš„ç›®å½•ä¸‹å³å¯</li> <li>é¡µé¢åˆ·æ–°åªéœ€è¦æ‹¦æˆªåˆ°ä¸»åº”ç”¨å³å¯ï¼Œä¸»åº”ç”¨å†…éƒ¨è‡ªå·±æ ¹æ®<code>activeWhen</code>å»æŒ‚è½½å¯¹åº”çš„å­åº”ç”¨</li></ul></blockquote> <p>è‡³æ­¤ï¼Œç®€å• single-spa æ­å»ºå·²å®Œæˆï¼Œæ·±å…¥äº†è§£å¯ç‚¹å‡»</p> <p><a href="https://juejin.cn/post/6862661545592111111#heading-72" target="_blank" rel="noopener noreferrer">å¾®å‰ç«¯æ¡†æ¶ ä¹‹ single-spa ä»å…¥é—¨åˆ°ç²¾é€š<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="qiankun"><a href="#qiankun" class="header-anchor">#</a> qiankun</h2> <p>qiankun æ˜¯åŸºäº single-spa åšäº†äºŒæ¬¡å°è£…çš„å¾®å‰ç«¯æ¡†æ¶ï¼Œé€šè¿‡è§£å†³äº† single-spa çš„ä¸€äº›å¼Šç«¯å’Œä¸è¶³ï¼Œæ¥å¸®åŠ©å¤§å®¶å®ç°æ›´ç®€å•ã€æ— ç—›çš„æ„å»ºä¸€ä¸ªç”Ÿäº§å¯ç”¨çš„å¾®å‰ç«¯æ¶æ„ç³»ç»Ÿã€‚</p> <blockquote><p>single-spa å­˜åœ¨çš„ä¸è¶³ï¼š</p></blockquote> <ul><li><strong>å¯¹å¾®åº”ç”¨çš„ä¾µå…¥æ€§å¤ªå¼º</strong></li> <li><strong>æ ·å¼éš”ç¦»é—®é¢˜</strong></li> <li><strong>JS éš”ç¦»</strong></li> <li><strong>èµ„æºé¢„åŠ è½½</strong></li> <li><strong>åº”ç”¨é—´é€šä¿¡</strong></li></ul> <p>qiankun åŸºäº single-spa åšå‡ºäº†æ”¹è¿›ï¼Œæ­¤å¤„ä¸æ·±ç©¶æºç ï¼Œåªæ¢å¯»å¦‚ä½•ä½¿ç”¨</p> <h3 id="å¼€å§‹æ­å»º-demo"><a href="#å¼€å§‹æ­å»º-demo" class="header-anchor">#</a> å¼€å§‹æ­å»º demo</h3> <h4 id="æ‹‰å–-demo-é¡¹ç›®"><a href="#æ‹‰å–-demo-é¡¹ç›®" class="header-anchor">#</a> æ‹‰å– demo é¡¹ç›®</h4> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">git</span> clone https://github.com/umijs/qiankun.git
$ <span class="token builtin class-name">cd</span> qiankun
</code></pre></div><h4 id="å®‰è£…æ‰€éœ€åŒ…"><a href="#å®‰è£…æ‰€éœ€åŒ…" class="header-anchor">#</a> å®‰è£…æ‰€éœ€åŒ…</h4> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">yarn</span> <span class="token function">install</span>
<span class="token function">yarn</span> examples:install
</code></pre></div><h4 id="è¿è¡Œ-2"><a href="#è¿è¡Œ-2" class="header-anchor">#</a> è¿è¡Œ</h4> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">yarn</span> examples:start
</code></pre></div><h4 id="è¿è¡Œåœ°å€"><a href="#è¿è¡Œåœ°å€" class="header-anchor">#</a> è¿è¡Œåœ°å€</h4> <p><a href="http://localhost:7099" target="_blank" rel="noopener noreferrer">http://localhost:7099<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h4 id="æ¡†æ¶ç›®å½•ç»“æ„"><a href="#æ¡†æ¶ç›®å½•ç»“æ„" class="header-anchor">#</a> æ¡†æ¶ç›®å½•ç»“æ„</h4> <p><img src="/assets/imgs/206589898f604e858ab810c1004cf7c2_tplv-k3u1fbpfcp-watermark.awebp" alt="img"></p> <p>demo é¡¹ç›®çš„åŸºåº§åº”ç”¨å‡†å¤‡ react å’Œ vue ä¸¤ä¸ªç‰ˆæœ¬ï¼Œå¾®åº”ç”¨ä¹Ÿå‡†å¤‡äº†ï¼Œreactã€vueã€angular ç­‰ç­‰ï¼Œç®—æ˜¯æ¯”è¾ƒå…¨é¢çš„ç¨‹åº</p> <p><img src="/assets/imgs/1631499010491.png" alt="1631499010491"></p> <p>å€¼å¾—æ³¨æ„çš„å‡ ç‚¹</p> <p>åœ¨ package.json ä¸­å®‰è£…äº† npm-run-all åŒ…ï¼Œå¯å¹¶è¡Œæˆ–é¡ºåºæ‰§è¡Œå¤šä¸ª npm è„šæœ¬ï¼Œè¿™æ ·å°±èƒ½ä¸€è¡Œä»£ç è¿è¡Œå¤šä¸ªåº”ç”¨</p> <p><img src="/assets/imgs/1631499498892.png" alt="1631499498892"></p> <p>father-buildï¼ŒåŸºäº rollup çš„åº“æ„å»ºå·¥å…·ï¼Œfather æ›´åŠ å¼ºå¤§</p> <p><img src="/assets/imgs/1631499685326.png" alt="1631499685326"></p> <p>main å’Œ module å­—æ®µï¼Œæ ‡è¯†ç»„ä»¶åº“çš„å…¥å£ï¼Œå½“ä¸¤è€…åŒæ—¶å­˜åœ¨æ—¶ï¼Œmodule å­—æ®µçš„ä¼˜å…ˆçº§é«˜äº main</p> <p><img src="/assets/imgs/1631499722616.png" alt="1631499722616"></p> <h3 id="ä¸»åº”ç”¨"><a href="#ä¸»åº”ç”¨" class="header-anchor">#</a> ä¸»åº”ç”¨</h3> <h4 id="ä½ç½®"><a href="#ä½ç½®" class="header-anchor">#</a> ä½ç½®</h4> <p>åŸºåº§åº”ç”¨ï¼ˆä¸»åº”ç”¨ï¼‰ä½äº example çš„ mainï¼š</p> <p><img src="/assets/imgs/1631499256238.png" alt="1631499256238"></p> <h4 id="webpack-æ–‡ä»¶"><a href="#webpack-æ–‡ä»¶" class="header-anchor">#</a> webpack æ–‡ä»¶</h4> <p>ä¸»åº”ç”¨ webpackï¼Œé…ç½®äº†ä¸€ä¸ªå¼€å‘æœåŠ¡å™¨ devServerã€ä¸¤ä¸ª loader (babel-loaderã€css loader)ã€ä¸€ä¸ªæ’ä»¶ HtmlWebpackPlugin</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> name <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./package'</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    entry<span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">MODE</span> <span class="token operator">===</span> <span class="token string">'multiple'</span> <span class="token operator">?</span> <span class="token string">'./multiple.js'</span> <span class="token operator">:</span> <span class="token string">'./index.js'</span><span class="token punctuation">,</span>
    devtool<span class="token operator">:</span> <span class="token string">'source-map'</span><span class="token punctuation">,</span>
    devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
        open<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token comment">// port: '7099',</span>
        port<span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">MODE</span> <span class="token operator">===</span> <span class="token string">'multiple'</span> <span class="token operator">?</span> <span class="token string">'7099'</span> <span class="token operator">:</span> <span class="token string">'7088'</span><span class="token punctuation">,</span>
        clientLogLevel<span class="token operator">:</span> <span class="token string">'warning'</span><span class="token punctuation">,</span>
        disableHostCheck<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        compress<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        headers<span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string">'Access-Control-Allow-Origin'</span><span class="token operator">:</span> <span class="token string">'*'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        historyApiFallback<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        overlay<span class="token operator">:</span> <span class="token punctuation">{</span> warnings<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> errors<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    output<span class="token operator">:</span> <span class="token punctuation">{</span>
        publicPath<span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    mode<span class="token operator">:</span> <span class="token string">'development'</span><span class="token punctuation">,</span>
    resolve<span class="token operator">:</span> <span class="token punctuation">{</span>
        extensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'.js'</span><span class="token punctuation">,</span> <span class="token string">'.jsx'</span><span class="token punctuation">,</span> <span class="token string">'.ts'</span><span class="token punctuation">,</span> <span class="token string">'.tsx'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    module<span class="token operator">:</span> <span class="token punctuation">{</span>
        rules<span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.jsx?$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                use<span class="token operator">:</span> <span class="token punctuation">{</span>
                    loader<span class="token operator">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
                    options<span class="token operator">:</span> <span class="token punctuation">{</span>
                        presets<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'@babel/preset-env'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                        plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'@babel/plugin-transform-react-jsx'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(le|c)ss$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'style-loader'</span><span class="token punctuation">,</span> <span class="token string">'css-loader'</span><span class="token punctuation">,</span> <span class="token string">'less-loader'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            filename<span class="token operator">:</span> <span class="token string">'index.html'</span><span class="token punctuation">,</span>
            template<span class="token operator">:</span>
                process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">MODE</span> <span class="token operator">===</span> <span class="token string">'multiple'</span>
                    <span class="token operator">?</span> <span class="token string">'./multiple.html'</span>
                    <span class="token operator">:</span> <span class="token string">'./index.html'</span><span class="token punctuation">,</span>
            minify<span class="token operator">:</span> <span class="token punctuation">{</span>
                removeComments<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                collapseWhitespace<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>é€šè¿‡ <code>webpack</code> é…ç½®æ–‡ä»¶çš„ <code>entry</code> å­—æ®µå¾—çŸ¥å…¥å£æ–‡ä»¶åˆ†åˆ«ä¸º <code>index.js</code> å’Œ <code>multiple.js</code></p> <h4 id="ä¸»åº”ç”¨è·¯ç”±é…ç½®-å®ç°åŸºäºè·¯ç”±æ”¹å˜åŠ è½½å¯¹åº”åº”ç”¨"><a href="#ä¸»åº”ç”¨è·¯ç”±é…ç½®-å®ç°åŸºäºè·¯ç”±æ”¹å˜åŠ è½½å¯¹åº”åº”ç”¨" class="header-anchor">#</a> ä¸»åº”ç”¨è·¯ç”±é…ç½®ï¼Œå®ç°åŸºäºè·¯ç”±æ”¹å˜åŠ è½½å¯¹åº”åº”ç”¨</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token string">'zone.js'</span> <span class="token comment">// for angular subapp</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
    registerMicroApps<span class="token punctuation">,</span>
    runAfterFirstMounted<span class="token punctuation">,</span>
    setDefaultMountApp<span class="token punctuation">,</span>
    start<span class="token punctuation">,</span>
    initGlobalState<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../es'</span>
<span class="token keyword">import</span> <span class="token string">'./index.less'</span>

<span class="token comment">/**
 * ä¸»åº”ç”¨ **å¯ä»¥ä½¿ç”¨ä»»æ„æŠ€æœ¯æ ˆ**
 * ä»¥ä¸‹åˆ†åˆ«æ˜¯ React å’Œ Vue çš„ç¤ºä¾‹ï¼Œå¯åˆ‡æ¢å°è¯•
 */</span>
<span class="token comment">// import render from './render/ReactRender';</span>
<span class="token keyword">import</span> render <span class="token keyword">from</span> <span class="token string">'./render/VueRender'</span>

<span class="token comment">/**
 * Step1 åˆå§‹åŒ–åº”ç”¨ï¼ˆå¯é€‰ï¼‰
 */</span>
<span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">{</span> loading<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token function-variable function">loader</span> <span class="token operator">=</span> <span class="token parameter">loading</span> <span class="token operator">=&gt;</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">{</span> loading <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">/**
 * Step2 æ³¨å†Œå­åº”ç”¨
 */</span>

<span class="token function">registerMicroApps</span><span class="token punctuation">(</span>
    <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            name<span class="token operator">:</span> <span class="token string">'react16'</span><span class="token punctuation">,</span>
            entry<span class="token operator">:</span> <span class="token string">'//localhost:7100'</span><span class="token punctuation">,</span>
            container<span class="token operator">:</span> <span class="token string">'#subapp-viewport'</span><span class="token punctuation">,</span>
            loader<span class="token punctuation">,</span>
            activeRule<span class="token operator">:</span> <span class="token string">'/react16'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            name<span class="token operator">:</span> <span class="token string">'react15'</span><span class="token punctuation">,</span>
            entry<span class="token operator">:</span> <span class="token string">'//localhost:7102'</span><span class="token punctuation">,</span>
            container<span class="token operator">:</span> <span class="token string">'#subapp-viewport'</span><span class="token punctuation">,</span>
            loader<span class="token punctuation">,</span>
            activeRule<span class="token operator">:</span> <span class="token string">'/react15'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            name<span class="token operator">:</span> <span class="token string">'vue'</span><span class="token punctuation">,</span>
            entry<span class="token operator">:</span> <span class="token string">'//localhost:7101'</span><span class="token punctuation">,</span>
            container<span class="token operator">:</span> <span class="token string">'#subapp-viewport'</span><span class="token punctuation">,</span>
            loader<span class="token punctuation">,</span>
            activeRule<span class="token operator">:</span> <span class="token string">'/vue'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            name<span class="token operator">:</span> <span class="token string">'angular9'</span><span class="token punctuation">,</span>
            entry<span class="token operator">:</span> <span class="token string">'//localhost:7103'</span><span class="token punctuation">,</span>
            container<span class="token operator">:</span> <span class="token string">'#subapp-viewport'</span><span class="token punctuation">,</span>
            loader<span class="token punctuation">,</span>
            activeRule<span class="token operator">:</span> <span class="token string">'/angular9'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            name<span class="token operator">:</span> <span class="token string">'purehtml'</span><span class="token punctuation">,</span>
            entry<span class="token operator">:</span> <span class="token string">'//localhost:7104'</span><span class="token punctuation">,</span>
            container<span class="token operator">:</span> <span class="token string">'#subapp-viewport'</span><span class="token punctuation">,</span>
            loader<span class="token punctuation">,</span>
            activeRule<span class="token operator">:</span> <span class="token string">'/purehtml'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            name<span class="token operator">:</span> <span class="token string">'vue3'</span><span class="token punctuation">,</span>
            entry<span class="token operator">:</span> <span class="token string">'//localhost:7105'</span><span class="token punctuation">,</span>
            container<span class="token operator">:</span> <span class="token string">'#subapp-viewport'</span><span class="token punctuation">,</span>
            loader<span class="token punctuation">,</span>
            activeRule<span class="token operator">:</span> <span class="token string">'/vue3'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        beforeLoad<span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token parameter">app</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
                    <span class="token string">'[LifeCycle] before load %c%s'</span><span class="token punctuation">,</span>
                    <span class="token string">'color: green;'</span><span class="token punctuation">,</span>
                    app<span class="token punctuation">.</span>name
                <span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        beforeMount<span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token parameter">app</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
                    <span class="token string">'[LifeCycle] before mount %c%s'</span><span class="token punctuation">,</span>
                    <span class="token string">'color: green;'</span><span class="token punctuation">,</span>
                    app<span class="token punctuation">.</span>name
                <span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        afterUnmount<span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token parameter">app</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
                    <span class="token string">'[LifeCycle] after unmount %c%s'</span><span class="token punctuation">,</span>
                    <span class="token string">'color: green;'</span><span class="token punctuation">,</span>
                    app<span class="token punctuation">.</span>name
                <span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> onGlobalStateChange<span class="token punctuation">,</span> setGlobalState <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">initGlobalState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    user<span class="token operator">:</span> <span class="token string">'qiankun'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token function">onGlobalStateChange</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> prev</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'[onGlobalStateChange - master]:'</span><span class="token punctuation">,</span> value<span class="token punctuation">,</span> prev<span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token function">setGlobalState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    ignore<span class="token operator">:</span> <span class="token string">'master'</span><span class="token punctuation">,</span>
    user<span class="token operator">:</span> <span class="token punctuation">{</span>
        name<span class="token operator">:</span> <span class="token string">'master'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">/**
 * Step3 è®¾ç½®é»˜è®¤è¿›å…¥çš„å­åº”ç”¨
 */</span>
<span class="token function">setDefaultMountApp</span><span class="token punctuation">(</span><span class="token string">'/react16'</span><span class="token punctuation">)</span>

<span class="token comment">/**
 * Step4 å¯åŠ¨åº”ç”¨
 */</span>
<span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token function">runAfterFirstMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'[MainApp] first app mounted'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="å…³äº-vuerender-js-ä¸åŠ è½½ä¸­æ˜¾ç¤ºæœ‰å…³"><a href="#å…³äº-vuerender-js-ä¸åŠ è½½ä¸­æ˜¾ç¤ºæœ‰å…³" class="header-anchor">#</a> å…³äº VueRender.jsï¼Œä¸åŠ è½½ä¸­æ˜¾ç¤ºæœ‰å…³</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue/dist/vue.esm'</span>

<span class="token keyword">function</span> <span class="token function">vueRender</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> loading <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
      &lt;div id=&quot;subapp-container&quot;&gt;
        &lt;h4 v-if=&quot;loading&quot; class=&quot;subapp-loading&quot;&gt;Loading...&lt;/h4&gt;
        &lt;div id=&quot;subapp-viewport&quot;&gt;&lt;/div&gt;
      &lt;/div&gt;
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
        el<span class="token operator">:</span> <span class="token string">'#subapp-container'</span><span class="token punctuation">,</span>
        <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
                loading<span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> app <span class="token operator">=</span> <span class="token keyword">null</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> loading <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>app<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        app <span class="token operator">=</span> <span class="token function">vueRender</span><span class="token punctuation">(</span><span class="token punctuation">{</span> loading <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        app<span class="token punctuation">.</span>loading <span class="token operator">=</span> loading
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="æ‰‹åŠ¨åŠ è½½å¾®åº”ç”¨"><a href="#æ‰‹åŠ¨åŠ è½½å¾®åº”ç”¨" class="header-anchor">#</a> æ‰‹åŠ¨åŠ è½½å¾®åº”ç”¨</h4> <p>é€šå¸¸è¿™ç§åœºæ™¯ä¸‹çš„å¾®åº”ç”¨æ˜¯ä¸€ä¸ªä¸å¸¦è·¯ç”±çš„å¯ç‹¬ç«‹è¿è¡Œçš„ä¸šåŠ¡ç»„ä»¶ï¼Œè¿™ç§ä½¿ç”¨æ–¹å¼çš„æƒ…å†µæ¯”è¾ƒå°‘è§</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> loadMicroApp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../es'</span>
<span class="token keyword">let</span> app
<span class="token keyword">function</span> <span class="token function">mount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    app <span class="token operator">=</span> <span class="token function">loadMicroApp</span><span class="token punctuation">(</span>
        <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'react15'</span><span class="token punctuation">,</span> entry<span class="token operator">:</span> <span class="token string">'//localhost:7102'</span><span class="token punctuation">,</span> container<span class="token operator">:</span> <span class="token string">'#react15'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> sandbox<span class="token operator">:</span> <span class="token punctuation">{</span> experimentalStyleIsolation<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">unmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    app<span class="token punctuation">.</span><span class="token function">unmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#mount'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> mount<span class="token punctuation">)</span>
document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#unmount'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> unmount<span class="token punctuation">)</span>

<span class="token function">loadMicroApp</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'vue'</span><span class="token punctuation">,</span> entry<span class="token operator">:</span> <span class="token string">'//localhost:7101'</span><span class="token punctuation">,</span> container<span class="token operator">:</span> <span class="token string">'#vue'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="vue-å­åº”ç”¨"><a href="#vue-å­åº”ç”¨" class="header-anchor">#</a> Vue å­åº”ç”¨</h3> <p>vue å­åº”ç”¨åœ¨ <code>examples/vue</code> ç›®å½•ä¸‹ï¼Œå°±æ˜¯ä¸€ä¸ªé€šè¿‡ vue-cli åˆ›å»ºçš„ vue demo åº”ç”¨ï¼Œç„¶åå¯¹ <code>vue.config.js</code> å’Œ <code>main.js</code> åšäº†ä¸€äº›æ›´æ”¹</p> <p><img src="/assets/imgs/1631500568350.png" alt="1631500568350"></p> <h4 id="vue-config-js"><a href="#vue-config-js" class="header-anchor">#</a> vue.config.js</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> name <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./package'</span><span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token parameter">dir</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> dir<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> port <span class="token operator">=</span> <span class="token number">7101</span> <span class="token comment">// dev port</span>
<span class="token comment">// publicPath æ²¡åœ¨è¿™é‡Œè®¾ç½®ï¼Œæ˜¯é€šè¿‡ webpack æä¾›çš„å…¨å±€å˜é‡ __webpack_public_path__ æ¥å³æ—¶è®¾ç½®çš„ï¼Œwebpackjs.com/guides/public-path/</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * You will need to set publicPath if you plan to deploy your site under a sub path,
     * for example GitHub Pages. If you plan to deploy your site to https://foo.github.io/bar/,
     * then publicPath should be set to &quot;/bar/&quot;.
     * In most cases please use '/' !!!
     * Detail: https://cli.vuejs.org/config/#publicpath
     */</span>
    outputDir<span class="token operator">:</span> <span class="token string">'dist'</span><span class="token punctuation">,</span>
    assetsDir<span class="token operator">:</span> <span class="token string">'static'</span><span class="token punctuation">,</span>
    filenameHashing<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment">// tweak internal webpack configuration.</span>
    <span class="token comment">// see https://github.com/vuejs/vue-cli/blob/dev/docs/webpack.md</span>
    devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// host: '0.0.0.0',</span>
        hot<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        disableHostCheck<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        port<span class="token punctuation">,</span>
        overlay<span class="token operator">:</span> <span class="token punctuation">{</span>
            warnings<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            errors<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        headers<span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token comment">// è®¾ç½®è·¨åŸŸï¼Œå› ä¸ºä¸»åº”ç”¨éœ€è¦é€šè¿‡ fetch å»è·å–å¾®åº”ç”¨å¼•å…¥çš„é™æ€èµ„æºçš„ï¼Œæ‰€ä»¥å¿…é¡»è¦æ±‚è¿™äº›é™æ€èµ„æºæ”¯æŒè·¨åŸŸ</span>
            <span class="token string">'Access-Control-Allow-Origin'</span><span class="token operator">:</span> <span class="token string">'*'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// è‡ªå®šä¹‰webpacké…ç½®</span>
    configureWebpack<span class="token operator">:</span> <span class="token punctuation">{</span>
        resolve<span class="token operator">:</span> <span class="token punctuation">{</span>
            alias<span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token string">'@'</span><span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        output<span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token comment">// æŠŠå­åº”ç”¨æ‰“åŒ…æˆ umd åº“æ ¼å¼</span>
            library<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-[name]</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
            libraryTarget<span class="token operator">:</span> <span class="token string">'umd'</span><span class="token punctuation">,</span>
            jsonpFunction<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">webpackJsonp_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="main-js"><a href="#main-js" class="header-anchor">#</a> main.js</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token string">'./public-path'</span>
<span class="token keyword">import</span> ElementUI <span class="token keyword">from</span> <span class="token string">'element-ui'</span>
<span class="token keyword">import</span> <span class="token string">'element-ui/lib/theme-chalk/index.css'</span>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> VueRouter <span class="token keyword">from</span> <span class="token string">'vue-router'</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App.vue'</span>
<span class="token keyword">import</span> routes <span class="token keyword">from</span> <span class="token string">'./router'</span>
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">'./store'</span>

Vue<span class="token punctuation">.</span>config<span class="token punctuation">.</span>productionTip <span class="token operator">=</span> <span class="token boolean">false</span>

Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>ElementUI<span class="token punctuation">)</span>

<span class="token keyword">let</span> router <span class="token operator">=</span> <span class="token keyword">null</span>
<span class="token keyword">let</span> instance <span class="token operator">=</span> <span class="token keyword">null</span>

<span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">props <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> container <span class="token punctuation">}</span> <span class="token operator">=</span> props
    <span class="token comment">// å®ä¾‹åŒ– routerï¼Œæ ¹æ®åº”ç”¨è¿è¡Œç¯å¢ƒè®¾ç½®è·¯ç”±å‰ç¼€</span>
    router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token comment">// ä½œä¸ºå¾®åº”ç”¨è¿è¡Œï¼Œåˆ™è®¾ç½® /vue ä¸ºå‰ç¼€ï¼Œå¦åˆ™è®¾ç½® /</span>
        base<span class="token operator">:</span> window<span class="token punctuation">.</span>__POWERED_BY_QIANKUN__ <span class="token operator">?</span> <span class="token string">'/vue'</span> <span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
        mode<span class="token operator">:</span> <span class="token string">'history'</span><span class="token punctuation">,</span>
        routes<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        router<span class="token punctuation">,</span>
        store<span class="token punctuation">,</span>
        <span class="token function-variable function">render</span><span class="token operator">:</span> <span class="token parameter">h</span> <span class="token operator">=&gt;</span> <span class="token function">h</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span>container <span class="token operator">?</span> container<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token string">'#app'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>window<span class="token punctuation">.</span>__POWERED_BY_QIANKUN__<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * ä» props ä¸­è·å–é€šä¿¡æ–¹æ³•ï¼Œç›‘å¬å…¨å±€çŠ¶æ€çš„æ›´æ”¹å’Œè®¾ç½®å…¨å±€çŠ¶æ€ï¼Œåªèƒ½æ“ä½œä¸€çº§å±æ€§
 * @param {*} props
 */</span>
<span class="token keyword">function</span> <span class="token function">storeTest</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    props<span class="token punctuation">.</span>onGlobalStateChange <span class="token operator">&amp;&amp;</span>
        props<span class="token punctuation">.</span><span class="token function">onGlobalStateChange</span><span class="token punctuation">(</span>
            <span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> prev</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
                    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">[onGlobalStateChange - </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>props<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">]:</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
                    value<span class="token punctuation">,</span>
                    prev
                <span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token boolean">true</span>
        <span class="token punctuation">)</span>
    props<span class="token punctuation">.</span>setGlobalState <span class="token operator">&amp;&amp;</span>
        props<span class="token punctuation">.</span><span class="token function">setGlobalState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            ignore<span class="token operator">:</span> props<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
            user<span class="token operator">:</span> <span class="token punctuation">{</span>
                name<span class="token operator">:</span> props<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">/**
 * å¯¼å‡ºçš„ä¸‰ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°
 */</span>
<span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'[vue] vue app bootstraped'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">mount</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'[vue] props from main framework'</span><span class="token punctuation">,</span> props<span class="token punctuation">)</span>
    <span class="token function">storeTest</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>
    <span class="token function">render</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">unmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    instance<span class="token punctuation">.</span><span class="token function">$destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    instance<span class="token punctuation">.</span>$el<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">''</span>
    instance <span class="token operator">=</span> <span class="token keyword">null</span>
    router <span class="token operator">=</span> <span class="token keyword">null</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="public-path-js"><a href="#public-path-js" class="header-anchor">#</a> public-path.js</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">/**
 * åœ¨å…¥å£æ–‡ä»¶ä¸­ä½¿ç”¨ ES6 æ¨¡å—å¯¼å…¥ï¼Œåˆ™åœ¨å¯¼å…¥åå¯¹ __webpack_public_path__ è¿›è¡Œèµ‹å€¼ã€‚
 * åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¿…é¡»å°†å…¬å…±è·¯å¾„(public path)èµ‹å€¼ç§»è‡³ä¸“å±æ¨¡å—ï¼Œç„¶åå°†å…¶åœ¨æœ€å‰é¢å¯¼å…¥
 */</span>
<span class="token comment">// qiankun è®¾ç½®çš„å…¨å±€å˜é‡ï¼Œè¡¨ç¤ºåº”ç”¨ä½œä¸ºå¾®åº”ç”¨åœ¨è¿è¡Œ</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>__POWERED_BY_QIANKUN__<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// eslint-disable-next-line no-undef</span>
    __webpack_public_path__ <span class="token operator">=</span> window<span class="token punctuation">.</span>__INJECTED_PUBLIC_PATH_BY_QIANKUN__
<span class="token punctuation">}</span>
</code></pre></div><p>å…¶ä»– demo å­é¡¹ç›®å‡æœ‰å®ä¾‹ï¼Œå…·ä½“å¯è‡ªå·±æŸ¥çœ‹ demo é¡¹ç›®</p> <h2 id="å°ç»“"><a href="#å°ç»“" class="header-anchor">#</a> å°ç»“</h2> <p>single-spa æä¾›äº†å¾®å‰ç«¯çš„æ¦‚å¿µï¼Œå…¶ä»æœ‰å¾ˆå¤šä¸è¶³å’Œéº»çƒ¦ï¼Œåæ¥ qiankun åŸºäºå…¶æ”¹è¿›å®Œå–„ï¼Œå¹¶ç»è¿‡èš‚èšå›¢é˜Ÿä¸Šçº¿æ‰“ç£¨åå¼€æºï¼Œ ä½¿å¾—æˆ‘ä»¬ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šæ­å»ºå¾®å‰ç«¯ã€‚å¯¹äºä½¿ç”¨æˆ‘ä»¬å¯èƒ½ä¸éœ€è¦å…³æ³¨åº•å±‚åŸç†ï¼Œå¦‚æœæƒ³äº†è§£ qiankun æ‰€ä½œçš„åŒ…æ‹¬ HTML Entryã€è¿è¡Œæ—¶æ²™ç®±ã€ èµ„æºé¢„åŠ è½½ã€åº”ç”¨é—´é€šä¿¡ç­‰åŸç†è¿˜æ˜¯éœ€è¦æˆ‘ä»¬æŸ¥çœ‹æºç å»ç†è§£åˆ†æã€‚</p> <p><a href="https://juejin.cn/post/6885211340999229454#heading-44" target="_blank" rel="noopener noreferrer">å¾®å‰ç«¯æ¡†æ¶ ä¹‹ qiankun ä»å…¥é—¨åˆ°æºç åˆ†æ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://qiankun.umijs.org/zh/guide" target="_blank" rel="noopener noreferrer">qiankun å®˜ç½‘<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">10/9/2021, 1:50:13 PM</span></div></footer> <!----> </main> <!----></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.053dbcbc.js" defer></script><script src="/assets/js/2.7f8ecedc.js" defer></script><script src="/assets/js/11.aebc598d.js" defer></script>
  </body>
</html>